<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login -Sarees Store</title>
  <style>
    body { 
      font-family: 'Segoe UI', Arial, sans-serif; 
      background: linear-gradient(135deg, #667eea, #764ba2); 
      margin: 0; 
      height: 100vh; 
      display: flex; 
      justify-content: center; 
      align-items: center; 
    }
    .card { 
      background: white; 
      padding: 40px; 
      border-radius: 20px; 
      box-shadow: 0 15px 35px rgba(0,0,0,0.3); 
      width: 420px; 
      text-align: center;
    }
    h2 { 
      color: #333; 
      margin-bottom: 20px; 
      font-weight: bold; 
    }
    input { 
      width: 100%; 
      padding: 14px; 
      margin: 12px 0; 
      border: 2px solid #ddd; 
      border-radius: 10px; 
      font-size: 16px; 
      transition: 0.3s;
    }
    input:focus { 
      border-color: #e4002b; 
      outline: none; 
    }
    button { 
      width: 100%; 
      padding: 14px; 
      background: #e4002b; 
      color: white; 
      border: none; 
      border-radius: 10px; 
      font-size: 18px; 
      font-weight: bold; 
      cursor: pointer; 
      transition: 0.3s;
    }
    button:hover { 
      background: #c80024; 
    }
    .error { 
      color: #e4002b; 
      font-weight: bold; 
      min-height: 24px; 
      margin: 10px 0; 
    }
    .success { 
      color: #28a745; 
      font-weight: bold; 
    }
    a { 
      color: #e4002b; 
      text-decoration: none; 
      font-weight: bold; 
    }
    a:hover { 
      text-decoration: underline; 
    }
    .quick-admin {
      margin-top: 20px;
      padding: 12px;
      background: #ff6b6b;
      color: white;
      border-radius: 10px;
      font-size: 14px;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <div class="card">
    <img src="assets/css/images/logo.png" alt="logo" width="80px">
    <h2>Login</h2>

    <div class="error" id="error"></div>

    <input type="text" id="email" placeholder="Email or Username" required>
    <input type="password" id="password" placeholder="Password" required>

    <button onclick="login()">Login</button>

    <p>No account? <a href="register.html">Register here</a></p>

    <!-- Quick Admin Login Button
    <div class="quick-admin" onclick="quickAdminLogin()">
      Admin Login (admin / 123456)
    </div>
  </div> -->

  <script>
    // Quick Admin Login Button
    function quickAdminLogin() {
      document.getElementById("email").value = "admin";
      document.getElementById("password").value = "123456";
      login();
    }

    async function login() {
      const emailInput = document.getElementById("email").value.trim();
      const password = document.getElementById("password").value;
      const errorDiv = document.getElementById("error");

      if (!emailInput || !password) {
        errorDiv.textContent = "Both fields are required";
        return;
      }

      errorDiv.textContent = "Logging in...";

      // Hardcoded Admin Login
      if (emailInput === "admin" && password === "123456") {
        localStorage.setItem("auth_token", "admin-jordan-token-2025");
        localStorage.setItem("current_user", JSON.stringify({ 
          email: "admin@jordanstore.com", 
          name: "Admin" 
        }));
        localStorage.setItem("isAdmin", "true"); // This unlocks admin panel
        errorDiv.className = "success";
        errorDiv.textContent = "Admin login successful!";
        setTimeout(() => window.location.href = "home.html", 1000);
        return;
      }

      // Try Real API Login (EscuelaJS)
      try {
        const res = await fetch("https://api.escuelajs.co/api/v1/auth/login", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email: emailInput, password })
        });

        if (res.ok) {
          const data = await res.json();
          localStorage.setItem("auth_token", data.access_token);
          localStorage.setItem("current_user", JSON.stringify({ 
            email: emailInput, 
            name: emailInput.split("@")[0] 
          }));

          // Optional: You can make any user admin if needed
          // if (emailInput === "some@email.com") localStorage.setItem("isAdmin", "true");

          errorDiv.className = "success";
          errorDiv.textContent = "Login successful!";
          setTimeout(() => window.location.href = "home.html", 800);
          return;
        }
      } catch (e) {
        console.log("API down or invalid creds, trying local...");
      }

      // Fallback: Local Registered Users
      const users = JSON.parse(localStorage.getItem("demo_users") || "[]");
      const user = users.find(u => u.email === emailInput && u.password === password);

      if (user) {
        localStorage.setItem("auth_token", "local-token-" + Date.now());
        localStorage.setItem("current_user", JSON.stringify({ 
          email: user.email, 
          name: user.name 
        }));
        errorDiv.className = "success";
        errorDiv.textContent = "Logged in (offline mode)";
        setTimeout(() => window.location.href = "home.html", 800);
      } else {
        errorDiv.textContent = "Invalid credentials";
      }
    }
  </script>
</body>

</html>

